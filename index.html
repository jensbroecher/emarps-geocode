<!doctype html>
<html>
<head>
<meta charset="utf-8">

<meta name="viewport" content="initial-scale=1, maximum-scale=1">

<link href="main.css" rel="stylesheet" type="text/css">
<link href="animate.min.css" rel="stylesheet" type="text/css">

<script src="jquery.min.js"></script>
<script type="text/javascript" src="cordova.js"></script>
<script type="text/javascript" src="cdv-plugin-parse.js"></script>

<script>

function onDeviceReady() {}

$( document ).ready(function() {

alert('App loaded');
	
$( "#getkptypes" ).load( "http://enunua.com/emarps/database/getkptypes_geocode_app.php", function() {
  alert( "KP Types loaded" );
});

parsePlugin.initialize('len2LWLxsk86rc83UuSoeeP3uGIJ9tU89o49cGIt','b6ut6CMfUVZWGKkyxe341gq0xe7eR9OK79ZJak7Z', function() {

    parsePlugin.subscribe('GPS', function() {

        parsePlugin.getInstallationId(function(id) {

        }, function(e) {
            alert('error');
        });

    }, function(e) {
        alert('error');
    });

}, function(e) {
    alert('error');
});

});

function lpush() {
window.plugin.notification.local.add({
    id:         1,
    message:    '',
    title:      'Welcome',
    autoCancel: true,
    ongoing:    false
});
}

$.ajaxSetup({
    beforeSend:function(){
        // show gif here, eg:
        $("#loading").fadeIn();
    },
    complete:function(){
        // hide gif here, eg:
        $("#loading").fadeOut();
    }
});

function geoFindMe() {
  var output = document.getElementById("out");

  if (!navigator.geolocation){
    output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
    return;
  }

  function success(position) {
    var latitude  = position.coords.latitude;
    var longitude = position.coords.longitude;

    output.innerHTML = '<p>Latitude is ' + latitude + '° <br>Longitude is ' + longitude + '°</p>';
	
	// alert(latitude);
	// alert(longitude);

    var img = new Image();
    img.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + longitude + "&zoom=13&size=400x400&sensor=false";
	img.className = "map";

    output.appendChild(img);
	
	document.getElementById('geofindbutton').style.display = "none";
	document.getElementById('detailsfordbbutton').style.display = "block";
	document.getElementById('locateagainbutton').style.display = "block";
	
	
  };

  function error() {
    output.innerHTML = "Unable to retrieve your location";
  };

  output.innerHTML = "<p>Locating…</p>";

  navigator.geolocation.getCurrentPosition(success, error);
}

function detailsfordb() {
	document.getElementById('detailsfordb').style.display = "block";
}

</script>

<div id="detailsfordb" style="display:none;" class="animated zoomIn">
<input placeholder="Facility Name" name="facilityname" required type="text"></input>
<input placeholder="Partner Name" name="partnername" required type="text"></input>
<input placeholder="County" name="county" required type="text"></input>
<div id="getkptypes"></div>
</div>

<button id="geofindbutton" onclick="geoFindMe()"><img align="absmiddle" src="locatemematerialdesign.png" width="40"> Find my location</button>

<button id="detailsfordbbutton" onclick="detailsfordb();"></button>

<button id="locateagainbutton" onclick="document.location.reload();"></button>

<div id="out"></div>

</body>
</html>